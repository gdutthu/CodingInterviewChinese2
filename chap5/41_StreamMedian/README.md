# 面试题41：数据流的中位数

问题描述：如何得到一个数据流中的中位数

备注：

如果数据流中读出奇数个数值，那么中位数就是所有数值排序之后的位于中间的数值

如果数据流中读出偶数个数值，那么中位数就是所有数值排序之后的中间两个数的平均值



牛客网OJ:[数据流的中位数](https://www.nowcoder.com/practice/9be0172896bd43948f8a32fb954e1be1?tpId=13&tqId=11216&rp=4)



**思路一：（一般用来处理静态数据，也就是数据本身不变化）**

1. 先对数组进行快速排序，算符复杂度为O(N*log N)
2. 当N为偶数的时候，中位数就排序后数组中间两个数的和再除以2。当N为奇数的时候，中位数就是排序后数组中间那个数值。

**思路一的弊端：**

每次要查询的时候，都要进行数组排序，不能做到实时查询。

**思路二：（一般用来处理动态数据，也就是数据还会不断增加进来）**

1. 采用两个堆结构来存放数组，其中一个是大根堆（用来存放个数N/2的较小的数值),另外一个是一个是小根堆（用来存放个数N/2的较大的数值),
2. 那么大根堆的堆顶元素就是较小的个数N/2的数组较小数值的最大值，小根堆的堆顶元素就是较大的个数N/2的数组较小数值的最小值。这两个堆顶元素就是这个数组的中位数。
3. 构建这两个堆的步骤如下：

- 数组不断弹出元素来插入到堆里面（array[i   for i in range(len(array)-1)] )，第一个元素默认进大根堆。然后在进行插入的时候，若数组的元素小于大根堆的堆顶元素，就进入大根堆，大于大根堆堆顶元素就进入小根堆。
- 时刻保持大根堆的元素个数和小根堆的元素个数差值不得大于2，如果大根堆元素个数多，就弹出大根堆的堆顶元素到小根堆的堆顶，然后对这两个堆都进行堆调整（即heapify操作）。